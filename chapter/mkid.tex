\chapter{超伝導検出器MKIDとその読み出し}

本章では、MKIDの動作原理の概要とその読み出し方法について述べる。MKIDの利点のひとつである周波数多重読み出しについて述べたあとに、市販のアナログ基板を用いた読み出し系の概要とその不満点を挙げる。本論文の主旨は、この不満を解消するものである。

% \begin{figure}[htbp]
%  \begin{tabular}{cc}
%   \begin{minipage}{0.5\hsize}
%    \centering
%    \includegraphics[height=50mm, clip]{figures/mkid_one.eps}
%    \caption{MKID}
%    \label{fig:mkid}
%   \end{minipage}
%   %\setcounter{figure}{1} % 図番号カウンターが更新されないとき
%   \begin{minipage}{0.5\hsize}
%    \centering
%    \includegraphics[height=50mm, clip]{figures/mkid_one_equiv.eps}
%    \caption{MKID の等価回路。}
%    \label{fig:mkid_equiv}
%   \end{minipage}
%  \end{tabular}
% \end{figure}

\section{動作原理}

Microwave Kinetic Inductance Detectors (MKID) は、2003年に発明された超伝導検出器である。図\ref{fig:mkid}右上に示すように、MKIDは電波を受信するアンテナと超伝導共振器、フィードラインから構成される。

図\ref{fig:mkid}左下にMKIDの等価回路を示す。MKIDはLC回路のひとつである。共振器はそれぞれ固有の共振周波数$\omega = 1/\sqrt{LC}$をもつ。ここで、$L$は共振器のインダクタンス、$C$は共振器とフィードラインのカップリングキャパシタンスを表す。

アンテナで受信した電波が共振器内のクーパー対を解離し、インダクタンスが変化する。MKIDはその変化を共振状態の変化として検出する。共振周波数は4--6 GHzに設定されることが多い。

\begin{figure}[htbp]
 \centering
 \includegraphics[width=14cm]{figures/mkid.png}
 \caption{MKIDの検出原理。受信した電波のエネルギーが$h\nu > 2\Delta$より大きいとき、超伝導状態の共振器内のクーパー対が解離し、$N_{\mathrm{qp}}=\eta h\nu/\Delta$個の準粒子が生成される（上左）。MKIDの等価回路。準粒子数の変化は系インダクタンスを変化させる（下左）。MKID（LC回路）が電波を受信すると、実線から破線へと共振周波数が変化する（中）。MKIDの基板図。アンテナと超伝導共振器、フィードラインからなり、超伝導共振器とフィードラインはACカップルしている（右上）。信号線の断面図。CPW（CoPlanar Waveguide）のジオメトリーを表す（右下）。}
 \label{fig:mkid}
\end{figure}

\section{周波数多重読み出し}

次世代のCMB偏光観測にとって、検出器の多素子化は重要な課題である。前章で述べたように、GroundBIRDは500個のMKIDを搭載する。読み出し系の一部は、室温系に設置するため、冷却系への読み出し線からの熱流入の抑制が肝要となる。この鍵を握るのが信号の多重化である。

信号の多重化には、主に周波数分割多重と時間分割多重、空間分割多重、符号分割多重など、様々な技術が存在する。MKIDは共振器の長さを変えることで、共振周波数を調整することができる。図\ref{fig:mkids}に示すように、少しずつ共振器の長さの異なったMKIDをフィードライン上に並べることで、周波数空間に信号を多重化することが可能となる。したがって、MKIDの読み出しは周波数分割多重が用いられる。

\begin{figure}[htbp]
 \centering
 \includegraphics[width=15cm]{figures/mkids.pdf}
 \caption{}
 \label{fig:mkids}
\end{figure}

\section{読み出し系}

読み出し系はMKIDの共振ピークの振幅と位相の変化を測定する。MKIDの読み出し方法には、DDC（Direct Down-Conversion）方式とFFT（Fast Fourier Transform）方式の二種類が存在し、本論文では共振周波数をより高い精度で設定できるDDC方式による読み出しについて述べる。

\subsection{読み出し系の構成と大まかな流れ}

読み出し系の構成を図\ref{fig:readout_system}に示す。読み出し系は大きく 4 つの要素に分けられる:
% \begin{enumerate}
%  \item 「冷却回路」: MKIDとLNA（Low Noise Amplifier）を含めたクライオスタット内にある読み出し部分。
%  \item 「MHz/GHzコンバーター」: MKIDに入力する読み出し信号を高周波（4--8 GHz）に変換（アップ・コンバード）、またはMKIDから出力される読み出し信号を低周波（$< 100$ MHz）に変換（ダウン・コンバート）する部分。
%  \item 「アナログ基板」: デジタル変調信号をアナログ信号に変換して送信し、アナログ信号を受信してデジタル信号に変換する部分。
%  \item 「デジタル基板」: アナログ基板に渡すデジタル信号を生成し、またデジタル信号を受け取り情報を処理する部分。
% \end{enumerate}
\begin{description}
 \item [冷却回路]: MKIDとLNA（Low Noise Amplifier）を含めたクライオスタット内にある読み出し部分。
 \item [MHz/GHzコンバーター]: MKIDに入力するフィード信号（読み出し用変調信号）を高周波（4--8 GHz）に変換（アップ・コンバード）、また、MKIDを通った後に出力されるフィード信号を低周波（$< 100$ MHz）に変換（ダウン・コンバート）する部分。
 \item [アナログ基板]: デジタル変調信号をアナログ信号に変換して送信し、入力したアナログ信号を受信してデジタル信号に変換する部分。
 \item [デジタル基板]: アナログ基板に渡すデジタル信号を生成し、またデジタル信号を受け取り情報を処理する部分。
\end{description}
本論文では、アナログ基板とデジタル基板をまとめてフロントエンド回路と呼ぶ。

\begin{figure}[htbp]
 \centering
 \includegraphics[width=12cm]{figures/readout_system.png}
 \caption{MKIDの読み出し系}
 \label{fig:readout_system}
\end{figure}

読み出しの大まかな流れは次のようになる:
\begin{enumerate}
 \item デジタル基板でデジタル変調信号を生成し、アナログ基板のDAC（Digital to Analog Converter）でアナログ変調して出力する。変調信号とは、複数の周波数（$< 100$ MHz）を重ね合わせた信号である。
 \item 局所発振器（LO）で出力した基準信号（通常、数GHz程度）とDACから出力したアナログ変調信号（MHz帯）をI/Q（In-phase/Quadrature-phase）ミキサーでGHz帯にアップ・コンバートしてフィード信号とする。
 \item フィード信号をMKIDに入力する。MKIDの共振器の共振によってフィード信号が変化する。アンテナ入力信号を共振状態（振幅と位相）の変化として計測する。
 \item MKIDの共振情報を含むフィード信号をLNAで増幅する。
 \item 増幅した信号と2.の基準信号をI/Qミキサーでダウン・コンバードする。
 \item アナログ基板のADC（Analog to Digital Converter）でMKIDにより変調された信号をデジタル変換し、デジタル基板で復調し、それぞれのMKIDの共振ピークの振幅と位相の変化を測定する。
\end{enumerate}

% \begin{figure}[htbp]
%  \begin{tabular}{cc}
%   \begin{minipage}{0.3\vsize}
%    \centering
%    \includegraphics[height=55mm, clip]{figures/readout_system.png}
%    \label{fig:readout_system}
%    \caption{MKIDの読み出し系の概念図}
%   \end{minipage}
%   \begin{minipage}{0.6\hsize}
%    \centering
%    \includegraphics[height=55mm, clip]{figures/readout_system_1.pdf}
%    \caption{既存のMKIDの読み出し系}
%    \label{fig:readout_system_now}
%   \end{minipage}
%  \end{tabular}
% \end{figure}

\subsection{読み出し原理}


\section{既存の読み出し系}

\begin{figure}[htbp]
 \centering
 \includegraphics[width=15cm, angle=90]{figures/readout_system_1.pdf}
 \caption{既存のMKIDの読み出し系}
 \label{fig:readout_system_now}
\end{figure}

\subsection{解決すべき課題}

FMC150はADCやDACの性能は読み出し系として満足する。しかし、読み出し系には不必要な機能が実装されているために、その性能を十分に活かせていない。また、性能以外にもユーザーの利便性を阻害する仕様が解決すべき課題として存在する。

\subsubsection{ローパスフィルターによる帯域の制限}

多重読み出しするためには、なるべく広い帯域を確保する必要がある。FMC150は図\ref{fig:low-pass}のようなローパスフィルターが実装されているため、82 MHz 以上の帯域を使用することができない。

読み出しの多重度は帯域の広さに比例する。MKIDの利点を最大化するためには、もっとも重要な点のひとつである。

\begin{figure}[htbp]
 \centering
 \includegraphics[width=14cm]{figures/low-pass.pdf}
 \caption{第5次チェビシェフフィルター。コーナー周波数は82 MHzに設計され、それより高い周波数は$-124.9$ dB/decadeで減衰する。}
 \label{fig:low-pass}
\end{figure}

% \begin{figure}[htbp]
%  \begin{tabular}{cc}
%   \begin{minipage}{0.5\hsize}
%    \centering
%    \includegraphics[height=5cm, clip]{figures/low-pass.png}
%    \label{fig:readout_system}
%   \end{minipage}
%   \begin{minipage}{0.5\hsize}
%    \centering
%    \includegraphics[height=5cm, clip]{figures/low-pass_1.png}
%    \label{fig:readout_system_now}
%   \end{minipage}
%  \end{tabular}
%  \caption{第5次チェビシェフフィルター。コーナー周波数は82 MHzに設計され、それより高い周波数は$-124.9$ dB/decadeで減衰する。}
% \end{figure}

\subsubsection{消費電力の過大}

消費電力の問題は、主にICの発熱の問題として表れる。ICは動作温度以上に発熱すると、読み出し系が不安定に、電源を供給しているデジタル基板がシャットダウンすることが確認されている。また、図\ref{fig:fan}のような冷却ファンによる排熱処理を怠ると基板上のICが熱破損する\footnote{実際に、冷却ファンなしで1時間程度運転し破損した}。

\begin{figure}[htbp]
 \centering
 \includegraphics[width=10cm]{figures/fan.pdf}
 \caption{FMC150のエアフローを向上させるために取り付けたUSB扇風機。ICの排熱処理は必須である。}
 \label{fig:fan}
\end{figure}

\subsubsection{ユーザビリティの毀損}

FMC150はクロックを分周して使うことを前提に設計されている。そのため、水晶発振器の周波数は245.76 MHzのもが搭載されている。しかし、現在の用途はクロックを様々な周波数に分周して使うことではない。クロックの周波数はADCとDACのサンプリング・レートを決めるため、できるだけ高い周波数のものが好ましいが、周波数分解能の値も重要である。実際にMKIDの測定を行う際は、まず帯域全体をスイープして、どの周波数にそれぞれのMKIDの共振ピークがあるか測定する。次に、それぞれのMKIDについてを定点観測を行う。このとき、ユーザーはあるMKIDの共振周ピーク付近に周波数を設定する必要がある。その際、指定する周波数は分解能の倍数に設定しなければならない。たとえば、FMC150で読み出し系を構成した場合、12.288 kHzの倍数にする必要がある。これは、ユーザーにとって非常に使いづらく誤った測定を誘発する。

また、読み出し系は冷却回路やMHz/GHzコンバーターで数GHzの信号を扱うため、同軸ケーブルのコネクターはSMA（Sub-Miniature version A）コネクターを用いている。一方で、FMC150はMMCX（Micro-Miniature CoaXial）を採用している。%測定を行う上で、ユーザーはコネクターの繋ぎ変えを頻繁に行う。そのときに、
コネクターの規格が不揃いだとユーザーの生産性を下げる。また、ユーザー側に規格変換のための余計なコネクター等の接続部品が増えることは、潜在的なバグを発生させる。